<div class="bill-container d-flex justify-content-center">
  <div class="col-lg-6 bg-light p-4 shadow-sm rounded-4">
    @if (bill(); as billRef) {
      <h1 data-cy="billTitle" class="bill-title mb-4" jhiTranslate="prosperPathApp.bill.detail.title">Bill Details</h1>

      <div class="block">
        <jhi-alert-error></jhi-alert-error>
        <jhi-alert></jhi-alert>

        <!-- Bill Basic Info -->
        <dl class="row-md jh-entity-details mb-4">
          <dt><span jhiTranslate="prosperPathApp.bill.name">Name</span></dt>
          <dd>
            <span>{{ billRef.name }}</span>
          </dd>

          <dt><span jhiTranslate="prosperPathApp.bill.amount">Amount</span></dt>
          <dd>
            <span class="fw-bold">{{ billRef.amount | currencyType }}</span>
          </dd>

          <dt><span jhiTranslate="prosperPathApp.bill.event">Event</span></dt>
          <dd>
            @if (billRef.event) {
              <a [routerLink]="['/event', billRef.event.id, 'view']" class="text-primary">
                {{ billRef.event.name }}
              </a>
            } @else {
              <span class="text-muted">—</span>
            }
          </dd>

          <dt><span jhiTranslate="prosperPathApp.bill.payer">Payer</span></dt>
          <dd>
            @if (billRef.payer) {
              <a [routerLink]="['/member', billRef.payer.id, 'view']" class="text-primary">
                {{ billRef.payer.name }}
              </a>
            } @else {
              <span class="text-muted">—</span>
            }
          </dd>
        </dl>

        <!-- Split Bill Section -->
        <h4 class="section-title" jhiTranslate="prosperPathApp.bill.splitBill">Split Bill</h4>
        <div class="member-split-list mb-4">
          @if (members.length === 0) {
            <div class="alert alert-info small py-2 text-center" jhiTranslate="prosperPathApp.bill.memAvailable">No members available</div>
          } @else {
            <!-- Select All Checkbox -->
            <div class="form-check mb-3 border-bottom pb-3">
              <input
                class="form-check-input me-3"
                type="checkbox"
                id="select-all"
                [checked]="allSelected"
                (change)="toggleSelectAll($event)"
              />
              <label class="form-check-label fw-bold" for="select-all" jhiTranslate="prosperPathApp.bill.selectAll"> Select All </label>
            </div>

            <!-- Members in 2 columns -->
            <div class="row">
              @for (m of members; track m.id; let i = $index) {
                <div class="col-6 mb-2">
                  <div class="form-check d-flex align-items-center">
                    <input
                      class="form-check-input me-3"
                      type="checkbox"
                      [id]="'member-' + m.id"
                      [(ngModel)]="m.selected"
                      (change)="updateSelectAllState()"
                    />
                    <label class="form-check-label flex-grow-1" [for]="'member-' + m.id">
                      {{ m.name }}
                    </label>
                  </div>
                </div>
              }
            </div>
          }
        </div>

        <button class="btn btn-warning btn-sm w-100 mb-3" (click)="saveParticipants()" jhiTranslate="prosperPathApp.bill.savaSplit">
          Save Split
        </button>

        <!-- Action Buttons -->
        <div class="action-buttons text-center">
          <button type="button" (click)="previousState()" class="btn btn-info" data-cy="entityDetailsBackButton">
            <fa-icon icon="arrow-left"></fa-icon>
          </button>

          <button type="button" [routerLink]="['/bill', billRef.id, 'edit']" class="btn btn-primary ms-2">
            <fa-icon icon="pencil-alt"></fa-icon>
          </button>
        </div>
      </div>
    }
  </div>
</div>
